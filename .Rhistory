x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20)+x2,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit$param_est
WindScot_gac_fit$gac_coef
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
~x2,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
~s(x1*x2),
~1),
loss="WLS")
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
~s(I(x1*x2)),
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
Z1 = cos(2*pi*N/24) + cos(2*pi*t(N)/24)
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
~s(I(x1*x2)),
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
~s(x2),
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
~s(x2,k=5),
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
~s(x2,k=5)+x1,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=10)+x2,
# ~s(x2,k=5)+x1,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=5)+x1,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20)+x2^2,
# ~s(x2,k=5)+x1,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=5)+x1,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
~te(x1,x2,k=5),
~1),
loss="WLS")
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
~te(x1,x2,k=10),
~1),
loss="WLS")
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
~s(x2,by=x1,k=10),
~1),
loss="WLS")
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
~s(x2,by=x1,k=5),
~1),
loss="WLS")
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
~s(x2,by=x1,k=100),
~1),
loss="WLS")
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
~x1*s(x2,k=10),
~1),
loss="WLS")
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
# ~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
~s(x2,k=10),
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=10),
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=10),
~1),
loss="WLS",smoothness_param = 0.02)
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=10),
~1),
loss="WLS",smoothness_param = 0.05)
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=10),
~1),
loss="WLS",smoothness_param = 0)
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
?PowExp
PowExp_cor_spec <- function(params,...){
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...) + params[[3]]*Z1
}
PowExp_cor_spec <- function(params,...){
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...) + params[[3]]*Z1
}
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec(),
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="WLS",smoothness_param = 0)
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...) #+ params[[3]]*Z1
PowExp_cor_spec <- function(params,...){
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...) #+ params[[3]]*Z1
}
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec(),
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~1,
~1),
loss="WLS",smoothness_param = 0)
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="WLS",smoothness_param = 0)
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit2 <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="LS",smoothness_param = 0)
lattice::levelplot(WindScot_gac_fit2$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit2 <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="WLS",smoothness_param = 0)
lattice::levelplot(WindScot_gac_fit2$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
gobs <- dcast(zone_dat[id=="wind_scotland",],
kfold+issueTime~id+lead_time,
value.var = c("g_val"),
drop = TRUE)
setorder(gobs,issueTime)
gobs[,1:10]
WindScot_Cov <- cor(gobs[,-c(1,2)],use = "pairwise.complete.obs")
col6 <- colorRampPalette(c("blue","cyan","yellow","red"))
lattice::levelplot(WindScot_Cov,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
r <- seq(0,48,by=0.5)
R <- as.matrix(dist(r))
## For correlation, need to fix sigma = 1, so covert to correlation function
PowExp_cor <- function(params,...){
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...)
}
## Static fit
WindScot_static_fit <- gac(R = R,
X = list(),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~1,
~1),
loss="WLS")
lattice::levelplot(WindScot_static_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
# "Dist along diagonal"
N <- length(r)
Z <- matrix(rep(1:N,N) + rep(1:N,each=N) - 1, N, N)/(2*N-1)
N <- matrix(rep(r,each=length(r)),length(r),length(r))
Z1 = cos(2*pi*N/24) + cos(2*pi*t(N)/24)
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=10),
~1),
loss="WLS",smoothness_param = 0)
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=10),
~1),
loss="LS",smoothness_param = 0)
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
WindScot_gac_fit <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
# ~s(x1,bs="bs",k=20)+x2,
# ~s(x2,k=10),
~1),
loss="WLS",smoothness_param = 0)
lattice::levelplot(WindScot_gac_fit$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
## Additive 2D-fourier term
PowExp_cor_spec <- function(params,...){
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...) + params[[3]]*Z1
}
WindScot_gac_fit2 <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="WLS",smoothness_param = 0)
WindScot_gac_fit2 <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="WLS")
## Additive 2D-fourier term
PowExp_cor_spec <- function(params,...){
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...) + params[[3]]*Z1
}
WindScot_gac_fit2 <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="WLS")
Z1
range(Z1)
## Additive 2D-fourier term
PowExp_cor_spec <- function(params,...){
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...) + params[[3]]*(2+Z1)
}
WindScot_gac_fit2 <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit2$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
Z1 = cos(2*pi*N/12) + cos(2*pi*t(N)/12)
## Additive 2D-fourier term
PowExp_cor_spec <- function(params,...){
PowExp(params = list(sigma=1,theta=params[[1]],gamma=params[[2]]),...) + params[[3]]*(2+Z1)
}
WindScot_gac_fit2 <- gac(R = R,
X = list(x1=c(Z),
x2=c(Z1)),
Emp_Cov = WindScot_Cov,
cov_func = PowExp_cor_spec,
param_eqns = list(#~1,
~s(x1,bs="bs",k=20),
~1,
~1),
loss="WLS")
lattice::levelplot(WindScot_gac_fit2$Cov_Est,xlab="node id", ylab="node id",
col.regions=col6(600), cuts=100, at=seq(-0.1,1,0.01),
scales=list(x=list(rot=45),y=list(rot=45),tck=0.3,cex=0.1))
